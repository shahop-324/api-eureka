
google client id
438235916836-6oaj1fbnqqrcd9ba30348fbe2ebn6lt0.apps.googleusercontent.com



app.get("/api-eureka/eureka/v1/auth/salesforce", function (req, res) {
  const oauth2 = new jsforce.OAuth2({
    clientId: process.env.SALESFORCE_CLIENT_ID,
    clientSecret: process.env.SALESFORCE_CLIENT_SECRET_ID,
    redirectUri: process.env.SALESFORCE_REDIRECT_URI,
  });
  res.redirect(oauth2.getAuthorizationUrl({}));
});

app.get("/api-eureka/eureka/v1/oauth/salesforce/callback", (req, res) => {
  console.log(req.query.code, "I am counting on you salesforce code");

  const oauth2 = new jsforce.OAuth2({
    clientId: process.env.SALESFORCE_CLIENT_ID,
    clientSecret: process.env.SALESFORCE_CLIENT_SECRET_ID,
    redirectUri: process.env.SALESFORCE_REDIRECT_URI,
  });
  const conn = new jsforce.Connection({ oauth2: oauth2 });
  conn.authorize(req.query.code, function (err, userInfo) {
    if (err) {
      return console.error(err);
    }
    const conn2 = new jsforce.Connection({
      instanceUrl: conn.instanceUrl,
      accessToken: conn.accessToken,
    });

    conn2
      .sobject("Account__c")
      .create({ Name: "dino testing" }, function (err, ret) {
        if (err || !ret.success) {
          return console.error(err, ret);
        }

        const conn3 = new jsforce.Connection({
          instanceUrl: conn.instanceUrl,
          accessToken: conn.accessToken,
        });

        console.log("Created record id : " + ret.id);
        conn3.sobject("Account__c").retrieve(ret.id, function (err, account) {
          if (err) {
            return console.error(err);
          }
          console.log("Name : " + account.Name);
          // ...
        });

        // ...
      });

    conn2.identity(function (err, res) {
      if (err) {
        return console.error(err);
      }
      console.log("user ID: " + res.user_id);
      console.log("organization ID: " + res.organization_id);
      console.log("username: " + res.username);
      console.log("display name: " + res.display_name);

      console.log("Access Token:" + conn.accessToken);
      console.log("Instance url:" + conn.instanceUrl);

      // res.status(200).json({
      //   status: "SUCCESS",
      // });


    });
  });

   res.status(200).json({
        status: "SUCCESS",
      });
});
